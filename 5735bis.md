---
title: Von Mises分布の確率密度関数を導出してみた。- panda大学習帳外伝
description: Von Mises分布の確率密度関数を導出してみたときのメモ書きです。
mathjax: true
encoding: UTF-8
---
{% include pagelink.md %}

# Von Mises分布の確率密度関数を導出してみた。

## 前置き

[この記事](https://pandanote.info/?p=5735)で整数次の(第1種)変形Bessel関数からなる関数列の母関数をTaylor展開すると、Von Mises分布の展開式を導出できて、かつそれを使うとVon Mises分布の累積分布関数を求めることができることを示しました。

また、「Von Mises分布の確率密度関数は2変量の正規分布の確率密度関数から導出できる。」ともののWikipedia等に書いてありますが、具体的な方法については書いていなかったりします。

そこで、具体的に計算してみることにしました。

{% include firstad.html %}

## 計算してみます。

### 2変量正規分布の確率密度関数

ここで唐突ですが、平均$\boldsymbol{\mu}$、正定値の分散共分散行列$\Sigma = \sigma^2 I = \left(
\begin{array}{cc}
\sigma^2 & 0 \cr
0 & \sigma^2
\end{array}\right)$($I$は$2\times 2$の単位行列)、確率変数を$\boldsymbol{x}$とすると、2変量正規分布の確率密度関数$p(\boldsymbol{x})$は…
\begin{align}
p(\boldsymbol{x}) &= \frac{1}{2\pi\sqrt{\det\Sigma}}\exp\left[ -\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu})^T\Sigma^{-1}(\boldsymbol{x}-\boldsymbol{\mu}) \right] \nonumber\cr
&= \frac{1}{2\pi\sigma^2}\exp\left[ -\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu})^T\left(
\begin{array}{cc}
\displaystyle\frac{1}{\sigma^2} & 0 \cr
0 & \dfrac{1}{\sigma^2}
\end{array}
\right)(\boldsymbol{x}-\boldsymbol{\mu}) \right] \nonumber\cr
&= \frac{1}{2\pi\sigma^2}\exp\left[ -\frac{1}{2\sigma^2}(\boldsymbol{x}-\boldsymbol{\mu})^2\right] \nonumber\cr
&= \frac{1}{2\pi\sigma^2}\exp\left[ -\frac{1}{2\sigma^2}(\\|\boldsymbol{x}\\|^2+\\|\boldsymbol{\mu}\\|^2-2\\|\boldsymbol{x}\\|\\|\boldsymbol{\mu}\\|\cos\theta)\right] \label{eq:mnddef}
\end{align}
と表すことができます。ただし、$\theta$は$\\|\boldsymbol{x}\\|$と$\\|\boldsymbol{\mu}\\|$が2次元の直交座標系(以下、単に「座標平面」と書きます。)においてなす角を表します。

{% include secondintervalad.html %}

### 変数変換

確率変数$\boldsymbol{x}$が持つ情報のうち、Von Mises分布では座標平面上$x軸$正の向きと$\boldsymbol{x}$のなす角($\phi$とします。)のみが必要ですので、(\ref{eq:mnddef})式を$\phi$を使った形に変形できないか考えます。そこで、$\boldsymbol{x} = (r\cos\phi,r\sin\phi)^T$とおくと…

\begin{align}
p(\boldsymbol{x})d\boldsymbol{x} &= p(\boldsymbol{x}(r,\phi))\left|\frac{\partial\boldsymbol{x}}{\partial r\partial\phi}\right|drd\phi \nonumber\cr
&= p(\boldsymbol{x}(r,\phi))\left|
\begin{array}{cc}
\cos\phi & -r\sin\phi \cr
\sin\phi & r\cos\phi
\end{array}
\right|drd\phi \nonumber\cr
&= p(\boldsymbol{x}(r,\phi))rdrd\phi \label{eq:probconv}
\end{align}

と変換できます。(\ref{eq:probconv})式に(\ref{eq:mnddef})式を適用すると…

\begin{align}
p(\boldsymbol{x}(r,\phi))r &= \frac{1}{2\pi\sigma^2}r\exp\left[ -\frac{1}{2\sigma^2}(r^2+\\|\boldsymbol{\mu}\\|^2-2r\\|\boldsymbol{\mu}\\|\cos\theta)\right] \label{eq:mnddefsecond}
\end{align}

となります。

### 長さは定数とみなします。

ここからは、角度以外の数は適当に置き換えつつ計算します。

まず、Cとおくと、

次にmとおくと、

{% include thirdintervalad.html %}

## まとめ
Wikipediaの記事やPRMLなどを読んでいてもいまいち$x_1 = r\cos\theta, x_2 = r\sin\theta$とおいて確率変数を変換した後の$r$の処理の方法がいまいち理解できていなかったのですが、「確率変数の変数変換を行った後は、$r$を変数とみなさず固定して考える。」こととしました。

これで、Von Mises分布に従う乱数を生成するコードをscratchから実装できますね。&#x1f44d;

この記事は以上です。

## リンク
[整数次の変形Bessel関数の母関数とVon Mises分布。のページに戻る](https://pandanote.info/?p=5735) \| {% include pagelink.md %}

{% include fourthintervalad.html %}
